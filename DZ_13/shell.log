[root@selinux ~]# systemctl start nginx
Job for nginx.service failed because the control process exited with error code. See "systemctl status nginx.service" and "journalctl -xe" for details.
[root@selinux ~]# clear
[root@selinux ~]# systemctl start nginx
Job for nginx.service failed because the control process exited with error code. See "systemctl status nginx.service" and "journalctl -xe" for details.
[root@selinux ~]# sealert -a /var/log/audit/audit.log
100% done
found 1 alerts in /var/log/audit/audit.log
--------------------------------------------------------------------------------

SELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 8099.

*****  Plugin catchall_boolean (89.3 confidence) suggests   ******************

If you want to allow httpd to run preupgrade
Then you must tell SELinux about this by enabling the 'httpd_run_preupgrade' boolean.

Do
setsebool -P httpd_run_preupgrade 1

*****  Plugin catchall (11.6 confidence) suggests   **************************

If you believe that nginx should be allowed name_bind access on the port 8099 tcp_socket by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:
# ausearch -c 'nginx' --raw | audit2allow -M my-nginx
# semodule -i my-nginx.pp


Additional Information:
Source Context                system_u:system_r:httpd_t:s0
Target Context                system_u:object_r:preupgrade_port_t:s0
Target Objects                port 8099 [ tcp_socket ]
Source                        nginx
Source Path                   /usr/sbin/nginx
Port                          8099
Host                          <Unknown>
Source RPM Packages           nginx-1.20.1-2.el7.x86_64
Target RPM Packages
Policy RPM                    selinux-policy-3.13.1-268.el7_9.2.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     selinux
Platform                      Linux selinux 3.10.0-1160.31.1.el7.x86_64 #1 SMP
                              Thu Jun 10 13:32:12 UTC 2021 x86_64 x86_64
Alert Count                   5
First Seen                    2021-07-03 08:50:57 UTC
Last Seen                     2021-07-03 12:54:55 UTC
Local ID                      0a0f7d1d-9887-4275-a429-e3c800b63359

Raw Audit Messages
type=AVC msg=audit(1625316895.651:1620): avc:  denied  { name_bind } for  pid=24704 comm="nginx" src=8099 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:preupgrade_port_t:s0 tclass=tcp_socket permissive=0


type=SYSCALL msg=audit(1625316895.651:1620): arch=x86_64 syscall=bind success=no exit=EACCES a0=6 a1=55f7c02116e8 a2=10 a3=7fff7788c660 items=0 ppid=1 pid=24704 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=nginx exe=/usr/sbin/nginx subj=system_u:system_r:httpd_t:s0 key=(null)

Hash: nginx,httpd_t,preupgrade_port_t,tcp_socket,name_bind

[root@selinux ~]# ^C
[root@selinux ~]# ^C
[root@selinux ~]# setsebool -P httpd_run_preupgrade 1
[root@selinux ~]# systemctl start nginx
[root@selinux ~]# semanage port -l
SELinux Port Type              Proto    Port Number

afs3_callback_port_t           tcp      7001
afs3_callback_port_t           udp      7001
afs_bos_port_t                 udp      7007
afs_fs_port_t                  tcp      2040
afs_fs_port_t                  udp      7000, 7005
afs_ka_port_t                  udp      7004
afs_pt_port_t                  tcp      7002
afs_pt_port_t                  udp      7002
afs_vl_port_t                  udp      7003
agentx_port_t                  tcp      705
agentx_port_t                  udp      705
amanda_port_t                  tcp      10080-10083
amanda_port_t                  udp      10080-10082
amavisd_recv_port_t            tcp      10024
amavisd_send_port_t            tcp      10025
amqp_port_t                    tcp      15672, 5671-5672
amqp_port_t                    udp      5671-5672
aol_port_t                     tcp      5190-5193
aol_port_t                     udp      5190-5193
apc_port_t                     tcp      3052
apc_port_t                     udp      3052
apcupsd_port_t                 tcp      3551
apcupsd_port_t                 udp      3551
apertus_ldp_port_t             tcp      539
apertus_ldp_port_t             udp      539
asterisk_port_t                tcp      1720
asterisk_port_t                udp      2427, 2727, 4569
audit_port_t                   tcp      60
auth_port_t                    tcp      113
bacula_port_t                  tcp      9103
bacula_port_t                  udp      9103
bctp_port_t                    tcp      8999
bctp_port_t                    udp      8999
bgp_port_t                     tcp      179, 2605
bgp_port_t                     udp      179, 2605
boinc_client_port_t            tcp      1043
boinc_client_port_t            udp      1034
boinc_port_t                   tcp      31416
brlp_port_t                    tcp      4101
certmaster_port_t              tcp      51235
chronyd_port_t                 udp      323
clamd_port_t                   tcp      3310
clockspeed_port_t              udp      4041
cluster_port_t                 tcp      5149, 40040, 50006-50008
cluster_port_t                 udp      5149, 50006-50008
cma_port_t                     tcp      1050
cma_port_t                     udp      1050
cobbler_port_t                 tcp      25151
collectd_port_t                udp      25826
commplex_link_port_t           tcp      4331, 5001
commplex_link_port_t           udp      5001
commplex_main_port_t           tcp      5000
commplex_main_port_t           udp      5000
comsat_port_t                  udp      512
condor_port_t                  tcp      9618
condor_port_t                  udp      9618
conman_port_t                  tcp      7890
conman_port_t                  udp      7890
connlcli_port_t                tcp      1358
connlcli_port_t                udp      1358
couchdb_port_t                 tcp      5984, 6984
couchdb_port_t                 udp      5984, 6984
ctdb_port_t                    tcp      4379
ctdb_port_t                    udp      4379
cvs_port_t                     tcp      2401
cvs_port_t                     udp      2401
cyphesis_port_t                tcp      6767, 6769, 6780-6799
cyphesis_port_t                udp      32771
cyrus_imapd_port_t             tcp      2005
daap_port_t                    tcp      3689
daap_port_t                    udp      3689
dbskkd_port_t                  tcp      1178
dcc_port_t                     udp      6276, 6277
dccm_port_t                    tcp      5679
dccm_port_t                    udp      5679
dey_keyneg_port_t              tcp      8750
dey_keyneg_port_t              udp      8750
dey_sapi_port_t                tcp      4330
dhcpc_port_t                   tcp      68, 546, 5546
dhcpc_port_t                   udp      68, 546, 5546
dhcpd_port_t                   tcp      547, 548, 647, 847, 7911
dhcpd_port_t                   udp      67, 547, 548, 647, 847
dict_port_t                    tcp      2628
distccd_port_t                 tcp      3632
dns_port_t                     tcp      53
dns_port_t                     udp      53
dnssec_port_t                  tcp      8955
dogtag_port_t                  tcp      7390
echo_port_t                    tcp      7
echo_port_t                    udp      7
efs_port_t                     tcp      520
embrace_dp_c_port_t            tcp      3198
embrace_dp_c_port_t            udp      3198
ephemeral_port_t               tcp      32768-61000
ephemeral_port_t               udp      32768-61000
epmap_port_t                   tcp      135
epmap_port_t                   udp      135
epmd_port_t                    tcp      4369
epmd_port_t                    udp      4369
fac_restore_port_t             tcp      5582
fac_restore_port_t             udp      5582
fingerd_port_t                 tcp      79
flash_port_t                   tcp      843, 1935
flash_port_t                   udp      1935
fmpro_internal_port_t          tcp      5003
fmpro_internal_port_t          udp      5003
freeipmi_port_t                tcp      9225
freeipmi_port_t                udp      9225
ftp_data_port_t                tcp      20
ftp_port_t                     tcp      21, 989, 990
ftp_port_t                     udp      989, 990
gatekeeper_port_t              tcp      1721, 7000
gatekeeper_port_t              udp      1718, 1719
gdomap_port_t                  tcp      538
gdomap_port_t                  udp      538
gds_db_port_t                  tcp      3050
gds_db_port_t                  udp      3050
gear_port_t                    tcp      43273
gear_port_t                    udp      43273
geneve_port_t                  tcp      6080
giftd_port_t                   tcp      1213
git_port_t                     tcp      9418
git_port_t                     udp      9418
glance_port_t                  tcp      9292
glance_port_t                  udp      9292
glance_registry_port_t         tcp      9191
glance_registry_port_t         udp      9191
gluster_port_t                 tcp      38465-38469, 24007-24027
gluster_port_t                 udp      24007-24027
gopher_port_t                  tcp      70
gopher_port_t                  udp      70
gpsd_port_t                    tcp      2947
hadoop_datanode_port_t         tcp      50010
hadoop_namenode_port_t         tcp      8020
hddtemp_port_t                 tcp      7634
hi_reserved_port_t             sctp     512-1023
hi_reserved_port_t             tcp      512-1023
hi_reserved_port_t             udp      512-1023
howl_port_t                    tcp      5335
howl_port_t                    udp      5353
hplip_port_t                   tcp      1782, 2207, 2208, 8290, 8292, 9100, 9101, 9102, 9220, 9221, 9222, 9280, 9281, 9282, 9290, 9291, 50000, 50002
http_cache_port_t              tcp      8080, 8118, 8123, 10001-10010
http_cache_port_t              udp      3130
http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000
i18n_input_port_t              tcp      9010
ibm_dt_2_port_t                tcp      1792
ibm_dt_2_port_t                udp      1792
imaze_port_t                   tcp      5323
imaze_port_t                   udp      5323
inetd_child_port_t             tcp      1, 9, 13, 19, 512, 544, 891, 892, 5666
inetd_child_port_t             udp      1, 9, 13, 19, 891, 892
innd_port_t                    tcp      119
intermapper_port_t             tcp      8181
interwise_port_t               tcp      7778
interwise_port_t               udp      7778
ionixnetmon_port_t             tcp      7410
ionixnetmon_port_t             udp      7410
ipmi_port_t                    udp      623, 664
ipp_port_t                     tcp      631, 8610-8614
ipp_port_t                     udp      631, 8610-8614
ipsecnat_port_t                tcp      4500
ipsecnat_port_t                udp      4500
ircd_port_t                    tcp      6667, 6697
isakmp_port_t                  udp      500
iscsi_port_t                   tcp      3260
isns_port_t                    tcp      3205, 51954
isns_port_t                    udp      3205
jabber_client_port_t           tcp      5222, 5223
jabber_interserver_port_t      tcp      5269, 5280
jabber_router_port_t           tcp      5347
jacorb_port_t                  tcp      3528, 3529
jboss_debug_port_t             tcp      8787
jboss_debug_port_t             udp      8787
jboss_management_port_t        tcp      4447, 4712, 7600, 9123, 9990, 9999, 18001
jboss_management_port_t        udp      4712, 9123
jboss_messaging_port_t         tcp      5445, 5455
kerberos_admin_port_t          tcp      749
kerberos_password_port_t       tcp      464
kerberos_password_port_t       udp      464
kerberos_port_t                tcp      88, 750, 4444
kerberos_port_t                udp      88, 750, 4444
keystone_port_t                tcp      35357
keystone_port_t                udp      35357
kprop_port_t                   tcp      754
ktalkd_port_t                  udp      517, 518
kubernetes_port_t              tcp      4001, 4194, 10250
l2tp_port_t                    tcp      1701
l2tp_port_t                    udp      1701
ldap_port_t                    tcp      389, 636, 3268, 3269, 7389
ldap_port_t                    udp      389, 636
lirc_port_t                    tcp      8765
llmnr_port_t                   tcp      5355
llmnr_port_t                   udp      5355
lltng_port_t                   tcp      5345
lmtp_port_t                    tcp      24, 2003
lmtp_port_t                    udp      24
lsm_plugin_port_t              tcp      18700
luci_port_t                    tcp      8084
mail_port_t                    tcp      2000, 3905
mailbox_port_t                 tcp      2004
matahari_port_t                tcp      49000
matahari_port_t                udp      49000
memcache_port_t                tcp      11211
memcache_port_t                udp      11211
milter_port_t                  tcp      8890, 8891, 8893
mmcc_port_t                    tcp      5050
mmcc_port_t                    udp      5050
mongod_port_t                  tcp      27017-27019, 28017-28019
monopd_port_t                  tcp      1234
mountd_port_t                  tcp      20048
mountd_port_t                  udp      20048
movaz_ssc_port_t               tcp      5252
movaz_ssc_port_t               udp      5252
mpd_port_t                     tcp      6600
ms_streaming_port_t            tcp      1755
ms_streaming_port_t            udp      1755
msnp_port_t                    tcp      1863
msnp_port_t                    udp      1863
mssql_port_t                   tcp      1433-1434
mssql_port_t                   udp      1433-1434
munin_port_t                   tcp      4949
munin_port_t                   udp      4949
mxi_port_t                     tcp      8005
mxi_port_t                     udp      8005
mysqld_port_t                  tcp      1186, 3306, 63132-63164
mysqlmanagerd_port_t           tcp      2273
mythtv_port_t                  tcp      6543-6544
nessus_port_t                  tcp      1241
netport_port_t                 tcp      3129
netport_port_t                 udp      3129
netsupport_port_t              tcp      5404, 5405
netsupport_port_t              udp      5404, 5405
neutron_port_t                 tcp      8775, 9696, 9697
nfs_port_t                     tcp      2049, 20048-20049
nfs_port_t                     udp      2049, 20048-20049
nmbd_port_t                    udp      137, 138
nodejs_debug_port_t            tcp      5858
nodejs_debug_port_t            udp      5858
nsd_control_port_t             tcp      8952
ntop_port_t                    tcp      3000-3001
ntop_port_t                    udp      3000-3001
ntp_port_t                     udp      123
oa_system_port_t               tcp      8022
oa_system_port_t               udp      8022
ocsp_port_t                    tcp      9080
openflow_port_t                tcp      6633, 6653
openhpid_port_t                tcp      4743
openhpid_port_t                udp      4743
openvpn_port_t                 tcp      1194
openvpn_port_t                 udp      1194
openvswitch_port_t             tcp      6634
oracle_port_t                  tcp      1521, 2483, 2484
oracle_port_t                  udp      1521, 2483, 2484
osapi_compute_port_t           tcp      8774
ovsdb_port_t                   tcp      6640
pdps_port_t                    tcp      1314
pdps_port_t                    udp      1314
pegasus_http_port_t            tcp      5988
pegasus_https_port_t           tcp      5989
pgpkeyserver_port_t            tcp      11371
pgpkeyserver_port_t            udp      11371
pingd_port_t                   tcp      9125
pki_ca_port_t                  tcp      829, 9180, 9701, 9443-9447
pki_kra_port_t                 tcp      10180, 10701, 10443-10446
pki_ocsp_port_t                tcp      11180, 11701, 11443-11446
pki_ra_port_t                  tcp      12888-12889
pki_tks_port_t                 tcp      13180, 13701, 13443-13446
pki_tps_port_t                 tcp      7888-7889
pktcable_cops_port_t           tcp      2126
pktcable_cops_port_t           udp      2126
pop_port_t                     tcp      106, 109, 110, 143, 220, 993, 995, 1109, 10993
portmap_port_t                 tcp      111
portmap_port_t                 udp      111
postfix_policyd_port_t         tcp      10031
postgresql_port_t              tcp      5432, 9898
postgrey_port_t                tcp      60000
pptp_port_t                    tcp      1723
pptp_port_t                    udp      1723
prelude_port_t                 tcp      4690
prelude_port_t                 udp      4690
presence_port_t                tcp      5298-5299
presence_port_t                udp      5298-5299
preupgrade_port_t              tcp      8099
printer_port_t                 tcp      515
prosody_port_t                 tcp      5280-5281
ptal_port_t                    tcp      5703
pulseaudio_port_t              tcp      4713
pulseaudio_port_t              udp      4713
puppet_port_t                  tcp      8140
pxe_port_t                     udp      4011
pyzor_port_t                   udp      24441
rabbitmq_port_t                tcp      25672
radacct_port_t                 tcp      1646, 1813
radacct_port_t                 udp      1646, 1813
radius_port_t                  tcp      1645, 1812, 18120-18121
radius_port_t                  udp      1645, 1812, 18120-18121
radsec_port_t                  tcp      2083
razor_port_t                   tcp      2703
redis_port_t                   tcp      6379, 16379, 26379
repository_port_t              tcp      6363
reserved_port_t                sctp     1-511
reserved_port_t                tcp      1-511
reserved_port_t                udp      1-511
ricci_modcluster_port_t        tcp      16851
ricci_modcluster_port_t        udp      16851
ricci_port_t                   tcp      11111
ricci_port_t                   udp      11111
rlogin_port_t                  tcp      543, 2105
rlogind_port_t                 tcp      513
rndc_port_t                    tcp      953, 8953
rndc_port_t                    udp      953
router_port_t                  tcp      521
router_port_t                  udp      520, 521
rsh_port_t                     tcp      514
rsync_port_t                   tcp      873
rsync_port_t                   udp      873
rtp_media_port_t               tcp      5004-5005
rtp_media_port_t               udp      5004-5005
rtsclient_port_t               tcp      2501
rtsp_port_t                    tcp      554, 8554
rtsp_port_t                    udp      554, 8554
rwho_port_t                    udp      513
salt_port_t                    tcp      4505, 4506
sap_port_t                     tcp      9875
sap_port_t                     udp      9875
saphostctrl_port_t             tcp      1128, 1129
servistaitsm_port_t            tcp      3636
servistaitsm_port_t            udp      3636
sge_port_t                     tcp      6444, 6445
shellinaboxd_port_t            tcp      4200
sieve_port_t                   tcp      4190
sip_port_t                     tcp      5060, 5061
sip_port_t                     udp      5060, 5061
sixxsconfig_port_t             tcp      3874
sixxsconfig_port_t             udp      3874
smbd_port_t                    tcp      445, 137-139
smtp_port_t                    tcp      25, 465, 587
snmp_port_t                    tcp      199, 1161, 161-162
snmp_port_t                    udp      161-162
soundd_port_t                  tcp      8000, 9433, 16001
spamd_port_t                   tcp      783, 10026, 10027
speech_port_t                  tcp      8036
squid_port_t                   tcp      3128, 3401, 4827
squid_port_t                   udp      3401, 4827
ssdp_port_t                    tcp      1900
ssdp_port_t                    udp      1900
ssh_port_t                     tcp      22
svn_port_t                     tcp      3690
svn_port_t                     udp      3690
svrloc_port_t                  tcp      427
svrloc_port_t                  udp      427
swat_port_t                    tcp      901
swift_port_t                   tcp      6200-6203
sype_transport_port_t          tcp      9911
sype_transport_port_t          udp      9911
syslog_tls_port_t              tcp      6514, 10514
syslog_tls_port_t              udp      6514, 10514
syslogd_port_t                 tcp      601, 20514
syslogd_port_t                 udp      514, 601, 20514
tangd_port_t                   tcp      7406
tcs_port_t                     tcp      30003
telnetd_port_t                 tcp      23
tftp_port_t                    udp      69
time_port_t                    tcp      37
time_port_t                    udp      37
tor_port_t                     tcp      6969, 9001, 9030, 9050, 9051, 9150
traceroute_port_t              udp      64000-64010
tram_port_t                    tcp      4567
transproxy_port_t              tcp      8081
trisoap_port_t                 tcp      10200
trisoap_port_t                 udp      10200
trivnet1_port_t                tcp      8200
trivnet1_port_t                udp      8200
unreserved_port_t              sctp     1024-65535
unreserved_port_t              tcp      61001-65535, 1024-32767
unreserved_port_t              udp      61001-65535, 1024-32767
ups_port_t                     tcp      3493
us_cli_port_t                  tcp      8082, 8083
us_cli_port_t                  udp      8082, 8083
uucpd_port_t                   tcp      540
varnishd_port_t                tcp      6081-6082
virt_migration_port_t          tcp      49152-49216
virt_port_t                    tcp      16509, 16514
virt_port_t                    udp      16509, 16514
virtual_places_port_t          tcp      1533
virtual_places_port_t          udp      1533
vnc_port_t                     tcp      5985-5999, 5900-5983
wap_wsp_port_t                 tcp      9200
wap_wsp_port_t                 udp      9200
wccp_port_t                    udp      2048
websm_port_t                   tcp      9090
websm_port_t                   udp      9090
whois_port_t                   tcp      43, 4321
whois_port_t                   udp      43, 4321
winshadow_port_t               tcp      3161
winshadow_port_t               udp      3261
wsdapi_port_t                  tcp      5357
wsdapi_port_t                  udp      5357
wsicopy_port_t                 tcp      3378
wsicopy_port_t                 udp      3378
xdmcp_port_t                   tcp      177
xdmcp_port_t                   udp      177
xen_port_t                     tcp      8002
xfs_port_t                     tcp      7100
xinuexpansion3_port_t          tcp      2023
xinuexpansion3_port_t          udp      2023
xinuexpansion4_port_t          tcp      2024
xinuexpansion4_port_t          udp      2024
xodbc_connect_port_t           tcp      6632
xserver_port_t                 tcp      6000-6020
zabbix_agent_port_t            tcp      10050
zabbix_port_t                  tcp      10051
zarafa_port_t                  tcp      236, 237
zebra_port_t                   tcp      2606, 2608-2609, 2600-2604
zebra_port_t                   udp      2606, 2608-2609, 2600-2604
zented_port_t                  tcp      1229
zented_port_t                  udp      1229
zookeeper_client_port_t        tcp      2181
zookeeper_election_port_t      tcp      3888
zookeeper_leader_port_t        tcp      2888
zope_port_t                    tcp      8021
[root@selinux ~]# semanage port -l |grep 80
amanda_port_t                  tcp      10080-10083
amanda_port_t                  udp      10080-10082
cyphesis_port_t                tcp      6767, 6769, 6780-6799
geneve_port_t                  tcp      6080
hadoop_namenode_port_t         tcp      8020
hplip_port_t                   tcp      1782, 2207, 2208, 8290, 8292, 9100, 9101, 9102, 9220, 9221, 9222, 9280, 9281, 9282, 9290, 9291, 50000, 50002
http_cache_port_t              tcp      8080, 8118, 8123, 10001-10010
http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000
jabber_interserver_port_t      tcp      5269, 5280
jboss_management_port_t        tcp      4447, 4712, 7600, 9123, 9990, 9999, 18001
luci_port_t                    tcp      8084
mongod_port_t                  tcp      27017-27019, 28017-28019
mxi_port_t                     tcp      8005
mxi_port_t                     udp      8005
oa_system_port_t               tcp      8022
oa_system_port_t               udp      8022
ocsp_port_t                    tcp      9080
pki_ca_port_t                  tcp      829, 9180, 9701, 9443-9447
pki_kra_port_t                 tcp      10180, 10701, 10443-10446
pki_ocsp_port_t                tcp      11180, 11701, 11443-11446
pki_tks_port_t                 tcp      13180, 13701, 13443-13446
preupgrade_port_t              tcp      8099
prosody_port_t                 tcp      5280-5281
soundd_port_t                  tcp      8000, 9433, 16001
speech_port_t                  tcp      8036
transproxy_port_t              tcp      8081
us_cli_port_t                  tcp      8082, 8083
us_cli_port_t                  udp      8082, 8083
xen_port_t                     tcp      8002
zope_port_t                    tcp      8021
[root@selinux ~]# semanage port -l |grep 80^C
[root@selinux ~]# setsebool -P httpd_run_preupgrade 0
[root@selinux ~]# systemctl start nginx
[root@selinux ~]# systemctl status nginx
● nginx.service - The nginx HTTP and reverse proxy server
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled)
   Active: active (running) since Sat 2021-07-03 13:19:43 UTC; 7min ago
  Process: 2399 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)
  Process: 2396 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)
  Process: 2395 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)
 Main PID: 2401 (nginx)
   CGroup: /system.slice/nginx.service
           ├─2401 nginx: master process /usr/sbin/nginx
           └─2403 nginx: worker process

Jul 03 13:19:43 selinux systemd[1]: Starting The nginx HTTP and reverse proxy server...
Jul 03 13:19:43 selinux nginx[2396]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
Jul 03 13:19:43 selinux nginx[2396]: nginx: configuration file /etc/nginx/nginx.conf test is successful
Jul 03 13:19:43 selinux systemd[1]: Started The nginx HTTP and reverse proxy server.
[root@selinux ~]# systemctl stop nginx
[root@selinux ~]# systemctl status nginx
● nginx.service - The nginx HTTP and reverse proxy server
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled)
   Active: inactive (dead)

Jul 03 13:08:36 selinux systemd[1]: nginx.service: control process exited, code=exited status=1
Jul 03 13:08:36 selinux systemd[1]: Failed to start The nginx HTTP and reverse proxy server.
Jul 03 13:08:36 selinux systemd[1]: Unit nginx.service entered failed state.
Jul 03 13:08:36 selinux systemd[1]: nginx.service failed.
Jul 03 13:19:43 selinux systemd[1]: Starting The nginx HTTP and reverse proxy server...
Jul 03 13:19:43 selinux nginx[2396]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
Jul 03 13:19:43 selinux nginx[2396]: nginx: configuration file /etc/nginx/nginx.conf test is successful
Jul 03 13:19:43 selinux systemd[1]: Started The nginx HTTP and reverse proxy server.
Jul 03 13:27:21 selinux systemd[1]: Stopping The nginx HTTP and reverse proxy server...
Jul 03 13:27:21 selinux systemd[1]: Stopped The nginx HTTP and reverse proxy server.
[root@selinux ~]# systemctl start nginx
Job for nginx.service failed because the control process exited with error code. See "systemctl status nginx.service" and "journalctl -xe" for details.
[root@selinux ~]# semanage port -a -t http_port_t -p tcp 8099
ValueError: Port tcp/8099 already defined
[root@selinux ~]# semanage port -m -t http_port_t -p tcp 8099
[root@selinux ~]# semanage port -l |grep 80
amanda_port_t                  tcp      10080-10083
amanda_port_t                  udp      10080-10082
cyphesis_port_t                tcp      6767, 6769, 6780-6799
geneve_port_t                  tcp      6080
hadoop_namenode_port_t         tcp      8020
hplip_port_t                   tcp      1782, 2207, 2208, 8290, 8292, 9100, 9101, 9102, 9220, 9221, 9222, 9280, 9281, 9282, 9290, 9291, 50000, 50002
http_cache_port_t              tcp      8080, 8118, 8123, 10001-10010
http_port_t                    tcp      8099, 80, 81, 443, 488, 8008, 8009, 8443, 9000
jabber_interserver_port_t      tcp      5269, 5280
jboss_management_port_t        tcp      4447, 4712, 7600, 9123, 9990, 9999, 18001
luci_port_t                    tcp      8084
mongod_port_t                  tcp      27017-27019, 28017-28019
mxi_port_t                     tcp      8005
mxi_port_t                     udp      8005
oa_system_port_t               tcp      8022
oa_system_port_t               udp      8022
ocsp_port_t                    tcp      9080
pki_ca_port_t                  tcp      829, 9180, 9701, 9443-9447
pki_kra_port_t                 tcp      10180, 10701, 10443-10446
pki_ocsp_port_t                tcp      11180, 11701, 11443-11446
pki_tks_port_t                 tcp      13180, 13701, 13443-13446
preupgrade_port_t              tcp      8099
prosody_port_t                 tcp      5280-5281
soundd_port_t                  tcp      8000, 9433, 16001
speech_port_t                  tcp      8036
transproxy_port_t              tcp      8081
us_cli_port_t                  tcp      8082, 8083
us_cli_port_t                  udp      8082, 8083
xen_port_t                     tcp      8002
zope_port_t                    tcp      8021
[root@selinux ~]# systemctl sta
start   status
[root@selinux ~]# systemctl start nginx
[root@selinux ~]# systemctl status nginx.service
● nginx.service - The nginx HTTP and reverse proxy server
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled)
   Active: active (running) since Sat 2021-07-03 13:31:21 UTC; 11s ago
  Process: 2601 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)
  Process: 2598 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)
  Process: 2597 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)
 Main PID: 2603 (nginx)
   CGroup: /system.slice/nginx.service
           ├─2603 nginx: master process /usr/sbin/nginx
           └─2604 nginx: worker process

Jul 03 13:31:21 selinux systemd[1]: Starting The nginx HTTP and reverse proxy server...
Jul 03 13:31:21 selinux nginx[2598]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
Jul 03 13:31:21 selinux nginx[2598]: nginx: configuration file /etc/nginx/nginx.conf test is successful
Jul 03 13:31:21 selinux systemd[1]: Started The nginx HTTP and reverse proxy server.
[root@selinux ~]# sealert -a /var/log/audit/audit.log
100% done
found 1 alerts in /var/log/audit/audit.log
--------------------------------------------------------------------------------

SELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 8099.

*****  Plugin catchall_boolean (89.3 confidence) suggests   ******************

If you want to allow httpd to run preupgrade
Then you must tell SELinux about this by enabling the 'httpd_run_preupgrade' boolean.

Do
setsebool -P httpd_run_preupgrade 1

*****  Plugin catchall (11.6 confidence) suggests   **************************

If you believe that nginx should be allowed name_bind access on the port 8099 tcp_socket by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:
# ausearch -c 'nginx' --raw | audit2allow -M my-nginx
# semodule -i my-nginx.pp


Additional Information:
Source Context                system_u:system_r:httpd_t:s0
Target Context                system_u:object_r:preupgrade_port_t:s0
Target Objects                port 8099 [ tcp_socket ]
Source                        nginx
Source Path                   /usr/sbin/nginx
Port                          8099
Host                          <Unknown>
Source RPM Packages           nginx-1.20.1-2.el7.x86_64
Target RPM Packages
Policy RPM                    selinux-policy-3.13.1-268.el7_9.2.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     selinux
Platform                      Linux selinux 3.10.0-1160.31.1.el7.x86_64 #1 SMP
                              Thu Jun 10 13:32:12 UTC 2021 x86_64 x86_64
Alert Count                   6
First Seen                    2021-07-03 08:50:57 UTC
Last Seen                     2021-07-03 13:27:26 UTC
Local ID                      fce76a37-1f7c-4af0-9f5a-af78ca9c5131

Raw Audit Messages
type=AVC msg=audit(1625318846.256:686): avc:  denied  { name_bind } for  pid=2477 comm="nginx" src=8099 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:preupgrade_port_t:s0 tclass=tcp_socket permissive=0


type=SYSCALL msg=audit(1625318846.256:686): arch=x86_64 syscall=bind success=no exit=EACCES a0=6 a1=5623bb0506e8 a2=10 a3=7ffdf62637c0 items=0 ppid=1 pid=2477 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=nginx exe=/usr/sbin/nginx subj=system_u:system_r:httpd_t:s0 key=(null)

Hash: nginx,httpd_t,preupgrade_port_t,tcp_socket,name_bind

[root@selinux ~]# semanage port --help
usage: semanage port [-h] [-n] [-N] [-S STORE] [ --add -t TYPE -p PROTOCOL -r RANGE ( port_name | port_range ) | --delete -p PROTOCOL ( port_name | port_range ) | --deleteall  | --extract  | --list -C | --modify -t TYPE -p PROTOCOL -r RANGE ( port_name | port_range ) ]

positional arguments:
  port                  port | port_range

optional arguments:
  -h, --help            show this help message and exit
  -C, --locallist       List port local customizations
  -n, --noheading       Do not print heading when listing port object types
  -N, --noreload        Do not reload policy after commit
  -S STORE, --store STORE
                        Select an alternate SELinux Policy Store to manage
  -a, --add             Add a record of the port object type
  -d, --delete          Delete a record of the port object type
  -m, --modify          Modify a record of the port object type
  -l, --list            List records of the port object type
  -E, --extract         Extract customizable commands, for use within a
                        transaction
  -D, --deleteall       Remove all port objects local customizations
  -t TYPE, --type TYPE  SELinux Type for the object
  -r RANGE, --range RANGE
                        MLS/MCS Security Range (MLS/MCS Systems only) SELinux
                        Range for SELinux login mapping defaults to the
                        SELinux user record range.
  -p PROTO, --proto PROTO
                        Protocol for the specified port (tcp|udp) or internet
                        protocol version for the specified node (ipv4|ipv6).
[root@selinux ~]# semanage port -d -t http_port_t -p tcp 8099
[root@selinux ~]# semanage port -l |grep 80
amanda_port_t                  tcp      10080-10083
amanda_port_t                  udp      10080-10082
cyphesis_port_t                tcp      6767, 6769, 6780-6799
geneve_port_t                  tcp      6080
hadoop_namenode_port_t         tcp      8020
hplip_port_t                   tcp      1782, 2207, 2208, 8290, 8292, 9100, 9101, 9102, 9220, 9221, 9222, 9280, 9281, 9282, 9290, 9291, 50000, 50002
http_cache_port_t              tcp      8080, 8118, 8123, 10001-10010
http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000
jabber_interserver_port_t      tcp      5269, 5280
jboss_management_port_t        tcp      4447, 4712, 7600, 9123, 9990, 9999, 18001
luci_port_t                    tcp      8084
mongod_port_t                  tcp      27017-27019, 28017-28019
mxi_port_t                     tcp      8005
mxi_port_t                     udp      8005
oa_system_port_t               tcp      8022
oa_system_port_t               udp      8022
ocsp_port_t                    tcp      9080
pki_ca_port_t                  tcp      829, 9180, 9701, 9443-9447
pki_kra_port_t                 tcp      10180, 10701, 10443-10446
pki_ocsp_port_t                tcp      11180, 11701, 11443-11446
pki_tks_port_t                 tcp      13180, 13701, 13443-13446
preupgrade_port_t              tcp      8099
prosody_port_t                 tcp      5280-5281
soundd_port_t                  tcp      8000, 9433, 16001
speech_port_t                  tcp      8036
transproxy_port_t              tcp      8081
us_cli_port_t                  tcp      8082, 8083
us_cli_port_t                  udp      8082, 8083
xen_port_t                     tcp      8002
zope_port_t                    tcp      8021
[root@selinux ~]# systemctl stop nginx
[root@selinux ~]# systemctl start nginx
\Job for nginx.service failed because the control process exited with error code. See "systemctl status nginx.service" and "journalctl -xe" for details.
[root@selinux ~]# sealert -a /var/log/audit/audit.log
100% done
found 1 alerts in /var/log/audit/audit.log
--------------------------------------------------------------------------------

SELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 8099.

*****  Plugin catchall_boolean (89.3 confidence) suggests   ******************

If you want to allow httpd to run preupgrade
Then you must tell SELinux about this by enabling the 'httpd_run_preupgrade' boolean.

Do
setsebool -P httpd_run_preupgrade 1

*****  Plugin catchall (11.6 confidence) suggests   **************************

If you believe that nginx should be allowed name_bind access on the port 8099 tcp_socket by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:
# ausearch -c 'nginx' --raw | audit2allow -M my-nginx
# semodule -i my-nginx.pp


Additional Information:
Source Context                system_u:system_r:httpd_t:s0
Target Context                system_u:object_r:preupgrade_port_t:s0
Target Objects                port 8099 [ tcp_socket ]
Source                        nginx
Source Path                   /usr/sbin/nginx
Port                          8099
Host                          <Unknown>
Source RPM Packages           nginx-1.20.1-2.el7.x86_64
Target RPM Packages
Policy RPM                    selinux-policy-3.13.1-268.el7_9.2.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     selinux
Platform                      Linux selinux 3.10.0-1160.31.1.el7.x86_64 #1 SMP
                              Thu Jun 10 13:32:12 UTC 2021 x86_64 x86_64
Alert Count                   7
First Seen                    2021-07-03 08:50:57 UTC
Last Seen                     2021-07-03 13:27:26 UTC
Local ID                      9eaae957-5789-4a7b-b498-5b5b5e4c16b9

Raw Audit Messages
type=AVC msg=audit(1625318846.256:686): avc:  denied  { name_bind } for  pid=2477 comm="nginx" src=8099 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:preupgrade_port_t:s0 tclass=tcp_socket permissive=0


type=SYSCALL msg=audit(1625318846.256:686): arch=x86_64 syscall=bind success=no exit=EACCES a0=6 a1=5623bb0506e8 a2=10 a3=7ffdf62637c0 items=0 ppid=1 pid=2477 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=nginx exe=/usr/sbin/nginx subj=system_u:system_r:httpd_t:s0 key=(null)

Hash: nginx,httpd_t,preupgrade_port_t,tcp_socket,name_bind

[root@selinux ~]# ausearch -c 'nginx' --raw | audit2allow -M my-nginx
******************** IMPORTANT ***********************
To make this policy package active, execute:

semodule -i my-nginx.pp

[root@selinux ~]# semodule -i my-nginx.pp
[root@selinux ~]# systemctl start nginx
[root@selinux ~]# systemctl status nginx
● nginx.service - The nginx HTTP and reverse proxy server
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled)
   Active: active (running) since Sat 2021-07-03 13:37:03 UTC; 13s ago
  Process: 2726 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)
  Process: 2723 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)
  Process: 2722 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)
 Main PID: 2728 (nginx)
   CGroup: /system.slice/nginx.service
           ├─2728 nginx: master process /usr/sbin/nginx
           └─2730 nginx: worker process

Jul 03 13:37:03 selinux systemd[1]: Starting The nginx HTTP and reverse proxy server...
Jul 03 13:37:03 selinux nginx[2723]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
Jul 03 13:37:03 selinux nginx[2723]: nginx: configuration file /etc/nginx/nginx.conf test is successful
Jul 03 13:37:03 selinux systemd[1]: Started The nginx HTTP and reverse proxy server.
[root@selinux ~]#
